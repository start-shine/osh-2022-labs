# osh-2022-labs lab3实验报告
本次实验实现了基础部分，没有完成后面标*的选做部分

## 双人聊天室 1.c
### 以'\n'分割消息
先读入一串消息，再逐个判断是否是换行符
### 发送大文件
如果读入的一串消息中不含换行符，那么说明这是一个大文件，下次需要继续发送它。做上标记，下次发送的时候删除前面的"Message:"提示符，说明这是一整条消息。

## 多人聊天室
### 简单的多人聊天室 2.c
用一个循环链表来实现，有用户加入或退出对应是插入或删除操作。如一共有四个用户的情况，a发送消息时，具体过程是a->b,b->c,c-d。
### 细粒度锁 2-2.cpp
用到了队列来实现。每次接受到一个消息，就将它放入其他用户对应的消息队列中，这一步需要加锁防止冲突。但是每次从消息队列中取一条消息发送给用户时，这一步不需要加锁。因为给不同的用户发消息可以并行而不会有冲突。

## 基于IO复用的多人聊天室 3.c
### SELECT
非阻塞的 socket实现，若无数据可读 recv 将直接返回，而不会阻塞住。再配合 select ，每次找出可读的文件描述符，就可以实现在一个线程中同时处理多个连接。